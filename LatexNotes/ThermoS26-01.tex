\newif\ifthermosubfile
\ifdefined\THERMONOTESMAIN
  \thermosubfilefalse
\else
  \thermosubfiletrue
\fi

\providecommand{\THERMOEND}{} % safe in both modes

\ifthermosubfile
  \documentclass[11pt]{book}
  \input{./Macros/thermoHead}
  \input{./Macros/thermoSymbols}
  \graphicspath{{./Figures/}}
  \begin{document}
  \renewcommand{\THERMOEND}{\end{document}}
\fi


\chapter{ThermoS26-01}
\label{chap:ThermoS26-01}

\section*{Non-Equilibrium Thermodynamics}
\addcontentsline{toc}{section}{Non-Equilibrium Thermodynamics}

\subsection*{Course Plan}
\begin{enumerate}
\item Equilibrium Thermodynamics
\item Statistical Mechanics
\item Kinetic Theory of Gases
\item Conservation Laws in Continuous Systems
\item Entropy Production
\item Onsager's Principle
\item Applications
\end{enumerate}

\section{Equilibrium Thermodynamics}

\begin{definition}[Isolated System]
\label{defn:isolated-system}
An isolated system is a collection of matter that shares no information with the outside world.
\end{definition}

\begin{figure}[h]
\centering
\includegraphics[width=\textwidth]{Figures/ThermoS26-01-fig-1}
\caption{Isolated system with rigid walls. The system is characterized by internal energy $U$, volume $V$, and mole numbers $N_1, \ldots, N_r$.}
\label{fig:isolated-system}
\end{figure}

\noindent\textbf{Postulate I:} There are particular states, called equilibrium states, of an isolated system that, macroscopically, are characterized by
\begin{itemize}
\item $U$, the internal energy of the system, $U \geq 0$,
\item $V$, the volume of the system, $V \geq 0$,
\item $N_1, \ldots, N_r$, the mole numbers of the $r$ chemical components of the system, $N_i \geq 0$.
\end{itemize}

The rigid walls that isolate the system from the rest of the universe allow no change in volume, no efflux of matter, and no exchange of energy.

\begin{definition}[Composite System]
\label{defn:composite-system}
A composite system is the union of two isolated systems that can exchange volume, matter (chemical components) and/or energy; however, no volume, matter, or energy is exchanged with outside.
\end{definition}

A \textbf{diathermal wall} in a composite system is one which separates two otherwise isolated systems and allows for the exchange of energy, but not matter or volume.

\begin{figure}[h]
\centering
\includegraphics[width=\textwidth]{Figures/ThermoS26-01-fig-2}
\caption{Composite system with diathermal wall separating subsystems $\alpha$ and $\beta$.}
\label{fig:diathermal-wall}
\end{figure}

A \textbf{diathermal piston} in a composite system is one which separates two otherwise isolated systems and allows for the exchange of energy and volume but not matter.

\noindent\textbf{Postulate II:} There exists a function $\tilde{S}$ for an isolated system called its entropy, defined for the system at equilibrium and depending on $U, V, N_1, \ldots, N_r$, \ie,
\begin{equation}
\label{eq:entropy-function}
\tilde{S} = \tilde{S}(U, V, N_1, \ldots, N_r).
\end{equation}

The entropy exists for a composite system and is the sum of the entropy functions, $\tilde{S}^\alpha$ and $\tilde{S}^\beta$, for the respective subsystems, \ie,
\begin{equation}
\label{eq:entropy-additive}
\tilde{S} = \tilde{S}^\alpha + \tilde{S}^\beta = \tilde{S}^\alpha(U^\alpha, V^\alpha, N_1^\alpha, \ldots, N_r^\alpha) + \tilde{S}^\beta(U^\beta, V^\beta, N_1^\beta, \ldots, N_r^\beta).
\end{equation}

The entropy of an isolated system is homogeneous of degree 1, meaning
\begin{equation}
\label{eq:entropy-homogeneous}
\tilde{S}(\lambda U, \lambda V, \lambda N_1, \ldots, \lambda N_r) = \lambda \tilde{S}(U, V, N_1, \ldots, N_r)
\end{equation}
for any $\lambda > 0$.

\noindent\textbf{Postulate III:} The entropy of an isolated system is a concave, twice continuously differentiable, positive function over its (convex) domain
\begin{equation}
\label{eq:domain-sigma-u}
\Sigma_u \subseteq [0,\infty)^{r+2} = \underbrace{[0, \infty)}_{(U)} \times \underbrace{[0, \infty)}_{(V)} \times \underbrace{[0, \infty)}_{(N_1)} \times \cdots \times \underbrace{[0, \infty)}_{(N_r)}.
\end{equation}

The entropy is a monotonically increasing function of $U$. In particular,
\begin{equation}
\label{eq:entropy-monotone}
\pderT{\tilde{S}}{U}{V, N_1, \ldots, N_r} > 0, \quad \forall (U, V, \vec{N}) \in \Sigma_u^o.
\end{equation}

\begin{theorem}
\label{thm:energy-representation}
Suppose that Postulates I--III hold for an isolated system. Then, there is a function
\begin{equation}
\label{eq:energy-function}
\tilde{U} = \tilde{U}(S, V, N_1, \ldots, N_r)
\end{equation}
and a convex domain of definition
\begin{equation}
\label{eq:domain-sigma-s}
\Sigma_s \subseteq [0,\infty)^{r+2} = \underbrace{[0, \infty)}_{(S)} \times \underbrace{[0, \infty)}_{(V)} \times \underbrace{[0, \infty)}_{(N_1)} \times \cdots \times \underbrace{[0, \infty)}_{(N_r)}
\end{equation}
that satisfies
\begin{equation}
\label{eq:energy-entropy-inverse-1}
\tilde{U}(\tilde{S}(U, V, \vec{N}), V, \vec{N}) = U, \quad \forall (U, V, \vec{N}) \in \Sigma_u
\end{equation}
and
\begin{equation}
\label{eq:energy-entropy-inverse-2}
\tilde{S}(\tilde{U}(S, V, \vec{N}), V, \vec{N}) = S, \quad \forall (S, V, \vec{N}) \in \Sigma_s.
\end{equation}

Moreover, $\tilde{U}$ is a twice continuously differentiable convex function with the property
\begin{equation}
\label{eq:energy-monotone}
\pderT{\tilde{U}}{S}{V, N_1, \ldots, N_r} > 0, \quad \forall (S, V, \vec{N}) \in \Sigma_s.
\end{equation}
\end{theorem}

\begin{example}
\label{ex:unary-system}
Suppose that, for a unary material ($r=1$),
\begin{equation}
\label{eq:example-entropy}
\tilde{S}(U, V, N) = \left(\frac{NVUR^2}{v_o \Theta}\right)^{1/3}, \quad \Sigma_u = [0, \infty)^3,
\end{equation}
where $R$, $v_o$, $\Theta > 0$ are constants. Consider the function
\begin{equation}
\label{eq:example-energy}
\tilde{U}(S, V, N) = \frac{S^3 v_o \Theta}{NVR^2}, \quad \Sigma_s = ?
\end{equation}

Then
\begin{equation}
\label{eq:example-inverse-1}
\tilde{S}(\tilde{U}(S, V, N), V, N) = S, \quad \forall (S, V, N) \in \Sigma_s
\end{equation}
and
\begin{equation}
\label{eq:example-inverse-2}
\tilde{U}(\tilde{S}(U, V, N), V, N) = U, \quad \forall (U, V, N) \in \Sigma_u.
\end{equation}
\end{example}

\begin{definition}[Temperature]
\label{defn:temperature}
Suppose that Postulates I--III hold. Then the temperature of an equilibrium isolated system is defined as
\begin{equation}
\label{eq:temperature-def}
T_u(S, V, N_1, \ldots, N_r) \equiv \pderT{U}{S}{V, N_1, \ldots, N_r}.
\end{equation}
\end{definition}

\noindent\textbf{Postulate IV:} Equilibrium of a composite system is that state $((U^\alpha, V^\alpha, \vec{N}^\alpha), (U^\beta, V^\beta, \vec{N}^\beta)) \in \Sigma^{\alpha} \times \Sigma^{\beta}$ such that
\begin{equation}
\label{eq:entropy-maximum}
S = S^\alpha + S^\beta
\end{equation}
is at its maximum possible value.

\begin{definition}[Pressure and Chemical Potential]
\label{defn:pressure-chemical-potential}
The function
\begin{equation}
\label{eq:pressure-def}
P_{\tilde{U}}(S, V, N_1, \ldots, N_r) := -\pderT{\tilde{U}}{V}{S, N_1, \ldots, N_r}
\end{equation}
is called the pressure of a system. The function
\begin{equation}
\label{eq:chemical-potential-def}
\mu_{u,i}(S, V, N_1, \ldots, N_r) := \pderT{\tilde{U}}{N_i}{S, V, N_j, j \neq i}
\end{equation}
is called the $i^{\text{th}}$ chemical potential.
\end{definition}

\begin{theorem}
\label{thm:entropy-partials}
Let $\tilde{S}$ and $\tilde{U}$ be the entropy and internal energy functions of an isolated system. Then,
\begin{equation}
\label{eq:entropy-partial-U}
\pder{\tilde{S}}{U} = \frac{1}{T_s(U, V, \vec{N})},
\end{equation}
where
\begin{equation}
\label{eq:temperature-consistency-1}
T_u(S, V, \vec{N}) = T_s(\tilde{U}(S, V, \vec{N}), V, \vec{N})
\end{equation}
and
\begin{equation}
\label{eq:temperature-consistency-2}
T_s(U, V, \vec{N}) = T_u(\tilde{S}(U, V, \vec{N}), V, \vec{N}).
\end{equation}

Furthermore,
\begin{equation}
\label{eq:entropy-partial-V}
\pder{\tilde{S}}{V} = \frac{P_s(U, V, \vec{N})}{T_s(U, V, \vec{N})},
\end{equation}
where
\begin{equation}
\label{eq:pressure-consistency-1}
P_{\tilde{U}}(S, V, \vec{N}) = P_s(\tilde{U}(S, V, \vec{N}), V, \vec{N}),
\end{equation}
and
\begin{equation}
\label{eq:pressure-consistency-2}
P_s(U, V, \vec{N}) = P_u(\tilde{S}(U, V, \vec{N}), V, \vec{N}).
\end{equation}

And, finally,
\begin{equation}
\label{eq:entropy-partial-N}
\pder{\tilde{S}}{N_j} = -\frac{\mu_{s,j}(U, V, \vec{N})}{T_s(U, V, \vec{N})},
\end{equation}
where
\begin{equation}
\label{eq:chemical-potential-consistency-1}
\mu_{u,j}(S, V, \vec{N}) = \mu_{s,j}(\tilde{U}(S, V, \vec{N}), V, \vec{N})
\end{equation}
and
\begin{equation}
\label{eq:chemical-potential-consistency-2}
\mu_{s,j}(U, V, \vec{N}) = \mu_{u,j}(\tilde{S}(U, V, \vec{N}), V, \vec{N}).
\end{equation}
\end{theorem}

\begin{proof}
Proof Exercises.
\end{proof}

\begin{remark}
We will usually abuse notation and just write
\begin{equation}
\label{eq:notation-abuse}
T_u = T_s, \quad P_{\tilde{U}} = P_s, \quad \mu_{u,j} = \mu_{s,i},
\end{equation}
when the usage may be inferred from the context.
\end{remark}

\noindent\textbf{Postulate V:} The entropy of an isolated system is zero when the temperature is zero; that is,
\begin{equation}
\label{eq:third-law}
T_s(U, V, N_1, \ldots, N_r) = 0 \implies \tilde{S}(U, V, N_1, \ldots, N_r) = 0.
\end{equation}

\begin{example}
\label{ex:absolute-zero}
Consider a unary ($r=1$) isolated system in equilibrium with the fundamental relation
\begin{equation}
\label{eq:example-fundamental}
\tilde{S}(U, V, N) = \left(\frac{NVUR^2}{v_o \Theta}\right)^{1/3}.
\end{equation}

We can set
\begin{equation}
\Sigma_u = [0, \infty)^3.
\end{equation}

$\tilde{S} = 0$ for all $(U, V, N) \in \partial \Sigma_u$, where
\begin{equation}
\label{eq:boundary-sigma-u}
\partial \Sigma_u = \{(U, V, N) \in \Sigma_u \mid U=0, \text{ or } V=0, \text{ or } N=0\}.
\end{equation}

Recall,
\begin{align}
\label{eq:temperature-example}
T_s(U, V, N) &= \frac{3 v_o \Theta}{NVR^2} \tilde{S}(U, V, N)^2 \notag \\
&= \frac{3 v_o \Theta}{NVR^2} \left(\frac{NVUR^2}{v_o \Theta}\right)^{2/3}.
\end{align}

$T_s$ is not defined for all of $\Sigma_u$! It is defined for all
\begin{equation}
(U, V, N) \in \text{dom}(T_s) \subset \Sigma_u.
\end{equation}

Define
\begin{equation}
\label{eq:absolute-zero-set}
AZ := \{(U, V, N) \in \text{dom}(T_s) \mid T_s(U, V, N) = 0\}.
\end{equation}

Then
\begin{equation}
AZ \subset \partial \Sigma_u. \quad (\text{Postulate V})
\end{equation}

I leave it as a homework exercise to determine $\text{dom}(T_s)$ and $AZ$.
\end{example}

\begin{remark}
From this point forward, we will assume that all postulates hold.
\end{remark}

\begin{theorem}[Thermal Equilibrium]
\label{thm:thermal-equilibrium}
Suppose that in a composite system $\alpha$ and $\beta$ are separated by a diathermal wall. Then, the equilibrium of the composite system may be characterized by
\begin{equation}
\label{eq:energy-conservation}
U^\alpha + U^\beta = U_o
\end{equation}
and
\begin{equation}
\label{eq:thermal-equilibrium}
T^\alpha(U^\alpha, V^\alpha, \vec{N}^\alpha) = T^\beta(U^\beta, V^\beta, \vec{N}^\beta).
\end{equation}
\end{theorem}

\begin{proof}
Internal energy may be exchanged between systems $\alpha$ and $\beta$ but cannot be exchanged with the outside world. Thus \eqref{eq:energy-conservation} must hold because of energy conservation. At equilibrium we must have
\begin{equation}
\label{eq:total-entropy-diathermal}
S(U^\alpha) = \tilde{S}^\alpha(U^\alpha, V^\alpha, \vec{N}^\alpha) + \tilde{S}^\beta(U_o - U^\alpha, V^\beta, \vec{N}^\beta)
\end{equation}
and
\begin{equation}
\label{eq:entropy-extremum}
\frac{\partial S}{\partial U^\alpha} = 0.
\end{equation}

Note, all other variables besides $U^\alpha$ are fixed.
\begin{align}
\label{eq:entropy-derivative-diathermal}
0 &= \frac{\partial S}{\partial U^\alpha} = \frac{\partial S^\alpha}{\partial U^\alpha} + \frac{\partial S^\beta}{\partial U^\beta} \frac{\partial}{\partial U^\alpha}(U_o - U^\alpha) \notag \\
&= [T^\alpha(U^\alpha, V^\alpha, \vec{N}^\alpha)]^{-1} + [T^\beta(U_o - U^\alpha, V^\beta, \vec{N}^\beta)]^{-1}(-1).
\end{align}

Thus,
\begin{equation}
T^\alpha(U^\alpha, V^\alpha, \vec{N}^\alpha) = T^\beta(U^\beta, V^\beta, \vec{N}^\beta)
\end{equation}
with
\begin{equation}
U^\beta = U_o - U^\alpha.
\end{equation}

How do we know that solutions exist and are unique?

\begin{figure}[h]
\centering
\includegraphics[width=\textwidth]{Figures/ThermoS26-01-fig-3}
\caption{Entropy functions vs $U^\alpha$ for subsystems $\alpha$ and $\beta$. The curves show $\tilde{S}^\alpha(U^\alpha)$ (convex, increasing) and $\tilde{S}^\beta(U_o - U^\alpha)$ (decreasing). The temperature conditions at the boundaries are indicated.}
\label{fig:entropy-vs-energy}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[width=0.8\textwidth]{Figures/ThermoS26-01-fig-4}
\caption{Total entropy $\tilde{S}(U^\alpha) = \tilde{S}^\alpha(U^\alpha) + \tilde{S}^\beta(U_o - U^\alpha)$ vs $U^\alpha$. The concave function achieves its maximum at $U_*$.}
\label{fig:total-entropy}
\end{figure}

This proof can also be carried out by using Lagrange multipliers. Set
\begin{equation}
\label{eq:lagrangian-diathermal}
J := S^\alpha(U^\alpha, V^\alpha, \vec{N}^\alpha) + S^\beta(U^\beta, V^\beta, \vec{N}^\beta) + \lambda(U^\alpha + U^\beta - U_o).
\end{equation}

Then, equilibrium is characterized by
\begin{align}
0 &= \frac{\partial J}{\partial U^\alpha} = [T^\alpha(U^\alpha, V^\alpha, \vec{N}^\alpha)]^{-1} + \lambda, \label{eq:lagrange-condition-1} \\
0 &= \frac{\partial J}{\partial U^\beta} = [T^\beta(U^\beta, V^\beta, \vec{N}^\beta)]^{-1} + \lambda, \label{eq:lagrange-condition-2} \\
0 &= \frac{\partial J}{\partial \lambda} = U^\alpha + U^\beta - U_o, \label{eq:lagrange-condition-3}
\end{align}
which yields the same result.
\end{proof}

The Lagrange Multiplier technique can be visualized as follows:

\begin{figure}[h]
\centering
\includegraphics[width=0.8\textwidth]{Figures/ThermoS26-01-fig-5}
\caption{Lagrange multiplier visualization: finding the maximum in $\tilde{S}$ along the constraint $U^\alpha + U^\beta = U_o$ (red line). The contours show increasing $\tilde{S}$.}
\label{fig:lagrange-visualization}
\end{figure}

\begin{theorem}[Thermal and Mechanical Equilibrium]
\label{thm:thermal-mechanical-equilibrium}
Suppose that in a composite system $\alpha$ and $\beta$ are separated by a diathermal piston. Then, the equilibrium of the composite system may be characterized by
\begin{equation}
\label{eq:energy-conservation-piston}
U^\alpha + U^\beta = U_o,
\end{equation}
\begin{equation}
\label{eq:volume-conservation}
V^\alpha + V^\beta = V_o,
\end{equation}
and
\begin{align}
T^\alpha(U^\alpha, V^\alpha, \vec{N}^\alpha) &= T^\beta(U^\beta, V^\beta, \vec{N}^\beta), \quad (\text{thermal equil.}) \label{eq:thermal-equil-piston} \\
P^\alpha(U^\alpha, V^\alpha, \vec{N}^\alpha) &= P^\beta(U^\beta, V^\beta, \vec{N}^\beta). \quad (\text{mechanical equil.}) \label{eq:mechanical-equil}
\end{align}
\end{theorem}

\begin{proof}
For this let us use the method of Lagrange multipliers. Note that $\vec{N}^\alpha$ and $\vec{N}^\beta$ are fixed. Define
\begin{equation}
\label{eq:lagrangian-piston}
J := S^\alpha(U^\alpha, V^\alpha, \vec{N}^\alpha) + S^\beta(U^\beta, V^\beta, \vec{N}^\beta) + \lambda_u(U^\alpha + U^\beta - U_o) + \lambda_v(V^\alpha + V^\beta - V_o).
\end{equation}

The conditions for equilibrium are
\begin{align}
0 &= \frac{\partial J}{\partial U^\alpha} = [T^\alpha(U^\alpha, V^\alpha, \vec{N}^\alpha)]^{-1} + \lambda_u, \label{eq:piston-condition-1} \\
0 &= \frac{\partial J}{\partial U^\beta} = [T^\beta(U^\beta, V^\beta, \vec{N}^\beta)]^{-1} + \lambda_u, \label{eq:piston-condition-2} \\
0 &= \frac{\partial J}{\partial V^\alpha} = \frac{P^\alpha(U^\alpha, V^\alpha, \vec{N}^\alpha)}{T^\alpha(U^\alpha, V^\alpha, \vec{N}^\alpha)} + \lambda_v, \label{eq:piston-condition-3} \\
0 &= \frac{\partial J}{\partial V^\beta} = \frac{P^\beta(U^\beta, V^\beta, \vec{N}^\beta)}{T^\beta(U^\beta, V^\beta, \vec{N}^\beta)} + \lambda_v, \label{eq:piston-condition-4}
\end{align}
and
\begin{align}
0 &= \frac{\partial J}{\partial \lambda_u} = U^\alpha + U^\beta - U_o, \label{eq:piston-condition-5} \\
0 &= \frac{\partial J}{\partial \lambda_v} = V^\alpha + V^\beta - V_o. \label{eq:piston-condition-6}
\end{align}

The result is clear.
\end{proof}

Here, we have used the fact that
\begin{align}
\pder{\tilde{S}^\alpha}{U^\alpha} &= \frac{1}{T^\alpha}, \label{eq:entropy-partial-identity-1} \\
\pder{S^\alpha}{V^\alpha} &= \frac{P^\alpha}{T^\alpha}, \label{eq:entropy-partial-identity-2} \\
\pder{S^\alpha}{N_i^\alpha} &= -\frac{\mu_i^\alpha}{T^\alpha}. \label{eq:entropy-partial-identity-3}
\end{align}

As a short hand, we will write
\begin{equation}
\label{eq:energy-differential}
d\tilde{U}^\alpha = T_u^\alpha dS^\alpha - P_u^\alpha dV^\alpha + \sum_{i=1}^r \mu_{u,i}^\alpha dN_i^\alpha
\end{equation}
and
\begin{equation}
\label{eq:entropy-differential}
d\tilde{S}^\alpha = \frac{1}{T_s^\alpha}dU^\alpha + \frac{P_s^\alpha}{T_s^\alpha} dV^\alpha - \sum_{i=1}^r \frac{\mu_{s,i}^\alpha}{T_s^\alpha} dN_i^\alpha.
\end{equation}

Using our abusive notations, we have
\begin{equation}
\label{eq:entropy-differential-abusive}
d\tilde{S}^\alpha = \frac{1}{T^\alpha}dU^\alpha + \frac{P^\alpha}{T^\alpha} dV^\alpha - \sum_{i=1}^r \frac{\mu_i^\alpha}{T^\alpha} dN_i^\alpha,
\end{equation}
for example.

\begin{theorem}[Full Equilibrium]
\label{thm:full-equilibrium}
Suppose that a composite system is comprised of two otherwise isolated systems with no barrier between the systems. Suppose that
\begin{equation}
S^\alpha = S^\alpha(U^\alpha, V^\alpha, \vec{N}^\alpha)
\end{equation}
and
\begin{equation}
S^\beta = S^\beta(U^\beta, V^\beta, \vec{N}^\beta)
\end{equation}
are the fundamental entropy relations for the two systems. Then the equilibrium state is defined by the relations
\begin{align}
U^\alpha + U^\beta &= U_o, \label{eq:full-equil-energy} \\
V^\alpha + V^\beta &= V_o, \label{eq:full-equil-volume} \\
N_i^\alpha + N_i^\beta &= N_{o,i}, \label{eq:full-equil-moles}
\end{align}
where $U_o, V_o, N_{o,i} > 0$, and
\begin{align}
T^\alpha(U^\alpha, V^\alpha, \vec{N}^\alpha) &= T^\beta(U^\beta, V^\beta, \vec{N}^\beta), \quad (\text{thermal equil.}) \label{eq:full-thermal} \\
P^\alpha(U^\alpha, V^\alpha, \vec{N}^\alpha) &= P^\beta(U^\beta, V^\beta, \vec{N}^\beta), \quad (\text{mech. equil.}) \label{eq:full-mechanical} \\
\mu_i^\alpha(U^\alpha, V^\alpha, \vec{N}^\alpha) &= \mu_i^\beta(U^\beta, V^\beta, \vec{N}^\beta). \quad (\text{chem. equil.}) \label{eq:full-chemical}
\end{align}
\end{theorem}

\begin{proof}
The procedure is the same. One can use the method of Lagrange multipliers to do the calculation. In particular, define
\begin{multline}
\label{eq:lagrangian-full}
J := S^\alpha(U^\alpha, V^\alpha, \vec{N}^\alpha) + S^\beta(U^\beta, V^\beta, \vec{N}^\beta) + \lambda_u(U^\alpha + U^\beta - U_o) \\
+ \lambda_v(V^\alpha + V^\beta - V_o) + \sum_{i=1}^r \lambda_i(N_i^\alpha + N_i^\beta - N_{o,i}).
\end{multline}
\end{proof}

\THERMOEND
